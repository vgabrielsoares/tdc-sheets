<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
    xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.20.xsd">

    <!-- Changeset 1: Criação dos tipos ENUM -->
    <changeSet id="001-create-enums" author="tdc-sheets">
        <comment>Criação dos tipos ENUM para o sistema TDC</comment>
        
        <!-- Enum para nomes de arquetipos -->
        <sql>
            CREATE TYPE "arquetipos_nome" AS ENUM (
              'ACADEMICO',
              'ACOLITO',
              'COMBATENTE',
              'FEITICEIRO',
              'LADINO',
              'NATURAL'
            );
        </sql>
        
        <!-- Enum para matrizes de feitiços -->
        <sql>
            CREATE TYPE "matriz_feiticos" AS ENUM (
              'ADIAFANA',
              'ANA',
              'ARCANA',
              'ELFICA',
              'GNOMICA',
              'INFERNAL',
              'LUZIDIA',
              'MUNDANA',
              'NATURAL',
              'PRIMORDIAL'
            );
        </sql>
        
        <!-- Enum para classes de feitiços -->
        <sql>
            CREATE TYPE "classes_feiticos" AS ENUM (
              'ABJURACAO',
              'DIVINACAO',
              'ELEMENTAL',
              'ENCANTAMENTO',
              'EVOCACAO',
              'ILUSAO',
              'INVOCACAO',
              'MANIPULACAO',
              'MISTICA',
              'NATURAL',
              'NECROMANCIA',
              'PROFANA',
              'SAGRADA',
              'TRANSLOCACAO',
              'TRANSMUTACAO'
            );
        </sql>
        
        <!-- Enum para graus de perícia -->
        <sql>
            CREATE TYPE "grau_pericia" AS ENUM (
              'LEIGO',
              'ADEPTO',
              'VERSADO',
              'MESTRE',
              'APEX_HUMANO'
            );
        </sql>
        
        <!-- Enum para atributos -->
        <sql>
            CREATE TYPE "atributos" AS ENUM (
              'AGILIDADE',
              'CONSTITUICAO',
              'FORCA',
              'INFLUENCIA',
              'MENTE',
              'PRESENCA'
            );
        </sql>
        
        <!-- Enum para tipos de dano -->
        <sql>
            CREATE TYPE "tipos_dano" AS ENUM (
              'ACIDO',
              'ELETRICO',
              'CORTANTE',
              'PERFURANTE',
              'IMPACTO',
              'FOGO',
              'FRIO',
              'INTERNO',
              'MENTAL',
              'MISTICO',
              'PROFANO',
              'SAGRADO',
              'SONORO',
              'VENENO'
            );
        </sql>
        
        <!-- Enum para raridades -->
        <sql>
            CREATE TYPE "raridades" AS ENUM (
              'COMUM',
              'ATIPICO',
              'RARO',
              'MUITO_RARO',
              'LENDARIO'
            );
        </sql>
        
        <!-- Enum para tipos de sentidos -->
        <sql>
            CREATE TYPE "tipos_sentidos" AS ENUM (
              'COMUM',
              'AGUCADO',
              'CEGO',
              'SURDO'
            );
        </sql>
        
        <!-- Enum para tipos de deslocamento -->
        <sql>
            CREATE TYPE "tipos_deslocamento" AS ENUM (
              'ANDANDO',
              'VOANDO',
              'NADANDO',
              'ESCALANDO',
              'ESCAVANDO'
            );
        </sql>
        
        <!-- Enum para tipos de alcance -->
        <sql>
            CREATE TYPE "tipos_alcance" AS ENUM (
              'PESSOAL',
              'ADJACENTE',
              'TOQUE',
              'CURTO',
              'MEDIO',
              'LONGO',
              'MUITO_lONGO',
              'ILIMITADO'
            );
        </sql>
        
        <!-- Enum para tipos de proficiência -->
        <sql>
            CREATE TYPE "tipos_proficiencia" AS ENUM (
              'ARMAS_SIMPLES',
              'ARMAS_COMPLEXAS',
              'ARMAS_MARCIAIS',
              'ARMAS_PESADAS',
              'IDIOMA_COMUM',
              'IDIOMA_PRIMORDIAL',
              'IDIOMA_RUNICO',
              'IDIOMA_ANAO',
              'IDIOMA_AQUATICO',
              'IDIOMA_DRACONICO',
              'IDIOMA_ELFICO',
              'IDIOMA_GIGANTE',
              'IDIOMA_GNOMICO',
              'IDIOMA_INFERNAL',
              'IDIOMA_OOPARNEELA',
              'IDIOMA_ORC',
              'IDIOMA_SILVESTRE',
              'IDIOMA_URURIMI',
              'PROTECAO_LEVE',
              'PROTECAO_MEDIA',
              'PROTECAO_PESADA',
              'ESCUDOS',
              'INTRUMENTO_HABILIDADE',
              'INTRUMENTO_OFICIO'
            );
        </sql>
        
        <!-- Enum para tipos de tamanho -->
        <sql>
            CREATE TYPE "tipos_tamanho" AS ENUM (
              'MINUSCULO',
              'PEQUENO',
              'MEDIO',
              'GRANDE',
              'ENORME',
              'COLOSSAL'
            );
        </sql>
        
        <!-- Enum para habilidades de resistência -->
        <sql>
            CREATE TYPE "habilidades_resistencia" AS ENUM (
              'DETERMINACAO',
              'REFLEXO',
              'TENACIDADE',
              'VIGOR'
            );
        </sql>
        
        <!-- Enum para tipos de resistência -->
        <sql>
            CREATE TYPE "tipos_resistencia" AS ENUM (
                'ATAQUE',
                'RESISTENCIA',
                'RESISTENCIA_PARCIAL',
                'AUTOMATICO'
            );
        </sql>
        
        <!-- Enum para tipos de equipamentos -->
        <sql>
            CREATE TYPE "tipos_equipamentos" AS ENUM (
                'PEDRAS_PRECIOSAS',
                'OBRAS_ARTES',
                'MERCADORIAS_TECIDOS',
                'MERCADORIAS_METAIS',
                'MERCADORIAS_ANIMAIS',
                'MERCADORIAS_PROVISOES',
                'AVENTURA_EXPLORACAO_VIAGEM',
                'COMIDA_BEBIDA',
                'FEITICARIA_CONDUITES',
                'FEITICARIA_POCOES',
                'FEITICARIA_OUTROS',
                'FERRAMENTAS_HABILIDADE',
                'FERRAMENTAS_OFICIO',
                'FONTES_LUZ',
                'HERBALISMO',
                'INSTRUMENTOS_MUSICAIS',
                'MUNICOES',
                'PRODUTOS_ALQUIMICOS',
                'RECIPIENTES',
                'UTILITARIOS',
                'VENENOS',
                'VESTIMENTAS',
                'ARMAS_SIMPLES',
                'ARMAS_MARCIAIS',
                'ARMAS_COMPLEXAS',
                'ARMAS_PESADAS',
                'PROTECOES_LEVES',
                'PROTECOES_MEDIAS',
                'PROTECOES_PESADAS',
                'ESCUDOS',
                'TRALHA',
                'MATERIAIS_INGREDIENTES',
                'MATERIAIS_CRIACAO'
            );
        </sql>
        
        <!-- Enum para tempo de ações -->
        <sql>
            CREATE TYPE "tempo_acoes" AS ENUM (
                'COMPLETA',
                'REACAO',
                'MAIOR',
                'DUAS_MENORES',
                'UMA_MENOR',
                'LIVRE'
            );
        </sql>
        
        <!-- Enum para idiomas -->
        <sql>
            CREATE TYPE "idiomas" AS ENUM (
              'COMUM',
              'PRIMORDIAL',
              'RUNICO',
              'ANAO',
              'AQUATICO',
              'DRACONICO',
              'ELFICO',
              'GIGANTE',
              'GNOMICO',
              'INFERNAL',
              'OOPARNEELA',
              'ORC',
              'SILVESTRE',
              'URURIMI'
            );
        </sql>
        
        <!-- Enum para alfabetos -->
        <sql>
            CREATE TYPE "alfabetos" AS ENUM (
                'COMUM',
                'PRIMORDIAL',
                'RUNICO',
                'GNOMICO',
                'AQUATICO',
                'DRACONICO',
                'ELFICO',
                'GIGANTE',
                'GLASNEE',
                'SILVESTRE'
            );
        </sql>
        
        <rollback>
            DROP TYPE IF EXISTS "arquetipos_nome";
            DROP TYPE IF EXISTS "matriz_feiticos";
            DROP TYPE IF EXISTS "classes_feiticos";
            DROP TYPE IF EXISTS "grau_pericia";
            DROP TYPE IF EXISTS "atributos";
            DROP TYPE IF EXISTS "tipos_dano";
            DROP TYPE IF EXISTS "raridades";
            DROP TYPE IF EXISTS "tipos_sentidos";
            DROP TYPE IF EXISTS "tipos_deslocamento";
            DROP TYPE IF EXISTS "tipos_alcance";
            DROP TYPE IF EXISTS "tipos_proficiencia";
            DROP TYPE IF EXISTS "tipos_tamanho";
            DROP TYPE IF EXISTS "habilidades_resistencia";
            DROP TYPE IF EXISTS "tipos_resistencia";
            DROP TYPE IF EXISTS "tipos_equipamentos";
            DROP TYPE IF EXISTS "tempo_acoes";
            DROP TYPE IF EXISTS "idiomas";
            DROP TYPE IF EXISTS "alfabetos";
        </rollback>
    </changeSet>

    <!-- Changeset 2: Criação das tabelas do sistema de usuários -->
    <changeSet id="002-create-user-tables" author="tdc-sheets">
        <comment>Criação das tabelas para usuários e autenticação</comment>
        
        <!-- Tabela de usuários -->
        <createTable tableName="user">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="nome_completo" type="VARCHAR(100)">
                <constraints nullable="false"/>
            </column>
            <column name="username" type="VARCHAR(50)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="email" type="VARCHAR(100)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="senha" type="VARCHAR(60)">
                <constraints nullable="false"/>
            </column>
            <column name="ativo" type="BOOLEAN" defaultValue="true">
                <constraints nullable="false"/>
            </column>
            <column name="primeiro_acesso" type="BOOLEAN" defaultValue="true">
                <constraints nullable="false"/>
            </column>
            <column name="data_nascimento" type="DATE"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="version" type="INTEGER" defaultValue="1">
                <constraints nullable="false"/>
            </column>
            <column name="created_by_user_id" type="BIGINT"/>
            <column name="updated_by_user_id" type="BIGINT"/>
            <column name="created_ip_address" type="VARCHAR(45)"/>
            <column name="updated_ip_address" type="VARCHAR(45)"/>
            <column name="deleted_at" type="TIMESTAMP"/>
            <column name="deleted_by_user_id" type="BIGINT"/>
            <column name="is_active" type="BOOLEAN" defaultValue="true">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de autoridades/roles -->
        <createTable tableName="authorities">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="authority" type="VARCHAR(50)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="descricao" type="VARCHAR(200)"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="version" type="INTEGER" defaultValue="1">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de relacionamento usuário-autoridade -->
        <createTable tableName="user_authority">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="user_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="authority_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="version" type="INTEGER" defaultValue="1">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Chaves estrangeiras -->
        <addForeignKeyConstraint baseTableName="user_authority" baseColumnNames="user_id"
                                 constraintName="fk_user_authority_user"
                                 referencedTableName="user" referencedColumnNames="id"
                                 onDelete="CASCADE" onUpdate="CASCADE"/>
        
        <addForeignKeyConstraint baseTableName="user_authority" baseColumnNames="authority_id"
                                 constraintName="fk_user_authority_authority"
                                 referencedTableName="authorities" referencedColumnNames="id"
                                 onDelete="CASCADE" onUpdate="CASCADE"/>
        
        <!-- Índices únicos -->
        <createIndex tableName="user_authority" indexName="idx_user_authority_unique">
            <column name="user_id"/>
            <column name="authority_id"/>
        </createIndex>
        
        <!-- Rollback -->
        <rollback>
            DROP TABLE IF EXISTS user_authority;
            DROP TABLE IF EXISTS authorities;
            DROP TABLE IF EXISTS "user";
        </rollback>
    </changeSet>

    <!-- Changeset 3: Criação das tabelas principais do sistema de fichas -->
    <changeSet id="003-create-ficha-tables" author="tdc-sheets">
        <comment>Criação das tabelas principais para fichas de personagem</comment>
        
        <!-- Tabela principal de ficha de personagem -->
        <createTable tableName="ficha_personagem">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="nome_personagem" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="user_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="background" type="TEXT"/>
            <column name="origem_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="linhagem_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="experiencia" type="INTEGER" defaultValue="0">
                <constraints nullable="false"/>
            </column>
            <column name="habilidade_assinatura" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="nivel_sorte" type="INTEGER" defaultValue="0">
                <constraints nullable="false"/>
            </column>
            <column name="tamanho" type="tipos_tamanho"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="version" type="INTEGER" defaultValue="1">
                <constraints nullable="false"/>
            </column>
            <column name="created_by_user_id" type="BIGINT"/>
            <column name="updated_by_user_id" type="BIGINT"/>
            <column name="created_ip_address" type="VARCHAR(45)"/>
            <column name="updated_ip_address" type="VARCHAR(45)"/>
            <column name="deleted_at" type="TIMESTAMP"/>
            <column name="deleted_by_user_id" type="BIGINT"/>
            <column name="is_active" type="BOOLEAN" defaultValue="true">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de defesa -->
        <createTable tableName="defesa">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="ficha_personagem_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="defesa_personagem" type="INTEGER" defaultValue="15">
                <constraints nullable="false"/>
            </column>
            <column name="armadura" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="vestindo_armadura" type="BOOLEAN" defaultValue="false"/>
            <column name="limite_agilidade" type="INTEGER"/>
            <column name="outro_mod" type="INTEGER"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de PV e PP -->
        <createTable tableName="pv_pp_personagem">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="ficha_personagem_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="pv_maximo" type="INTEGER" defaultValue="15">
                <constraints nullable="false"/>
            </column>
            <column name="pv_atual" type="INTEGER" defaultValue="15">
                <constraints nullable="false"/>
            </column>
            <column name="pv_temporario" type="INTEGER"/>
            <column name="pp_maximo" type="INTEGER" defaultValue="2">
                <constraints nullable="false"/>
            </column>
            <column name="pp_atual" type="INTEGER" defaultValue="2">
                <constraints nullable="false"/>
            </column>
            <column name="pp_temporario" type="INTEGER"/>
            <column name="limite_pp" type="INTEGER"/>
            <column name="limite_pp_bonus" type="INTEGER"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de arquetipos -->
        <createTable tableName="arquetipo">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="nome" type="arquetipos_nome">
                <constraints nullable="false"/>
            </column>
            <column name="pv_inicial" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="pp_inicial" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="pv_nivel" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="pp_nivel" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="defesa_5" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="defesa_10" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="defesa_15" type="INTEGER">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de relacionamento arquetipo-personagem -->
        <createTable tableName="arquetipos_personagem">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="ficha_personagem_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="arquetipo_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="nivel_arquetipo" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="is_active" type="BOOLEAN" defaultValue="true">
                <constraints nullable="false"/>
            </column>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de origens -->
        <createTable tableName="origem">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="nome" type="VARCHAR(100)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="descricao" type="TEXT"/>
            <column name="atributo_origem" type="VARCHAR(50)"/>
            <column name="valor_origem" type="INTEGER"/>
            <column name="habilidade_especial" type="TEXT"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de linhagens -->
        <createTable tableName="linhagem">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="nome" type="VARCHAR(100)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="descricao" type="TEXT"/>
            <column name="origem_relacionada" type="VARCHAR(100)"/>
            <column name="bonus_atributos" type="VARCHAR(255)"/>
            <column name="habilidades_especiais" type="TEXT"/>
            <column name="idiomas_automaticos" type="VARCHAR(255)"/>
            <column name="idiomas_bonus" type="VARCHAR(255)"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de habilidades -->
        <createTable tableName="habilidade">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="nome" type="VARCHAR(100)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="descricao" type="TEXT"/>
            <column name="atributo_principal" type="VARCHAR(50)"/>
            <column name="tipo" type="VARCHAR(50)"/>
            <column name="categoria" type="VARCHAR(50)"/>
            <column name="combate" type="BOOLEAN" defaultValue="false"/>
            <column name="graduacao_maxima" type="INTEGER" defaultValue="5"/>
            <column name="sinergias" type="VARCHAR(255)"/>
            <column name="pre_requisitos" type="TEXT"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de feitiços -->
        <createTable tableName="feiticos">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="nome" type="VARCHAR(100)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="descricao" type="TEXT"/>
            <column name="circulo" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="matriz" type="matriz_feiticos"/>
            <column name="classe_feitico" type="classes_feiticos"/>
            <column name="componentes" type="VARCHAR(255)"/>
            <column name="alcance" type="VARCHAR(100)"/>
            <column name="duracao" type="VARCHAR(100)"/>
            <column name="efeito" type="TEXT"/>
            <column name="aprimoramento" type="TEXT"/>
            <column name="pre_requisitos" type="TEXT"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de equipamentos -->
        <createTable tableName="equipamentos">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="nome" type="VARCHAR(100)">
                <constraints nullable="false"/>
            </column>
            <column name="raridade" type="raridades"/>
            <column name="peso" type="INTEGER"/>
            <column name="preco" type="VARCHAR(50)"/>
            <column name="tipo" type="tipos_equipamentos"/>
            <column name="descricao" type="TEXT"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de particularidades -->
        <createTable tableName="particularidade">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="particularidade" type="VARCHAR(100)">
                <constraints nullable="false"/>
            </column>
            <column name="efeito" type="TEXT"/>
            <column name="oposto" type="INTEGER"/>
            <column name="pontos" type="INTEGER"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de tamanhos -->
        <createTable tableName="tamanho">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="nome" type="tipos_tamanho">
                <constraints nullable="false" primaryKey="true"/>
            </column>
            <column name="alcance" type="INTEGER"/>
            <column name="dano" type="VARCHAR(10)"/>
            <column name="defesa" type="INTEGER"/>
            <column name="quadrados" type="DECIMAL(3,1)"/>
            <column name="peso_carregado" type="INTEGER"/>
            <column name="manobras" type="INTEGER"/>
            <column name="nd_rastro" type="INTEGER"/>
            <column name="acrobacia" type="INTEGER"/>
            <column name="atletismo" type="INTEGER"/>
            <column name="furtividade" type="INTEGER"/>
            <column name="reflexos" type="INTEGER"/>
            <column name="tenacidade" type="INTEGER"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de classes -->
        <createTable tableName="classe">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="nome" type="VARCHAR(100)">
                <constraints nullable="false"/>
            </column>
            <column name="descricao" type="TEXT"/>
            <column name="defesa_5" type="INTEGER"/>
            <column name="defesa_10" type="INTEGER"/>
            <column name="defesa_15" type="INTEGER"/>
            <column name="defesa_20" type="INTEGER"/>
            <column name="pm_5" type="INTEGER"/>
            <column name="pm_10" type="INTEGER"/>
            <column name="pm_15" type="INTEGER"/>
            <column name="pm_20" type="INTEGER"/>
            <column name="pv_5" type="INTEGER"/>
            <column name="pv_10" type="INTEGER"/>
            <column name="pv_15" type="INTEGER"/>
            <column name="pv_20" type="INTEGER"/>
            <column name="habilidade_especial" type="TEXT"/>
            <column name="modificador_xp" type="INTEGER"/>
            <column name="nivel_maximo" type="INTEGER"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de atributos do personagem -->
        <createTable tableName="atributos_personagem">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="ficha_personagem_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="atributo" type="atributos">
                <constraints nullable="false"/>
            </column>
            <column name="valor_base" type="INTEGER" defaultValue="10"/>
            <column name="modificador_origem" type="INTEGER" defaultValue="0"/>
            <column name="modificador_linhagem" type="INTEGER" defaultValue="0"/>
            <column name="modificador_equipamento" type="INTEGER" defaultValue="0"/>
            <column name="modificador_temporario" type="INTEGER" defaultValue="0"/>
            <column name="valor_total" type="INTEGER" defaultValue="10"/>
            <column name="is_active" type="BOOLEAN" defaultValue="true">
                <constraints nullable="false"/>
            </column>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de inventário do personagem -->
        <createTable tableName="inventario_personagem">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="ficha_personagem_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="equipamento_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="quantidade" type="INTEGER" defaultValue="1">
                <constraints nullable="false"/>
            </column>
            <column name="equipado" type="BOOLEAN" defaultValue="false">
                <constraints nullable="false"/>
            </column>
            <column name="is_active" type="BOOLEAN" defaultValue="true">
                <constraints nullable="false"/>
            </column>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de habilidades do personagem -->
        <createTable tableName="habilidades_personagem">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="ficha_personagem_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="habilidade_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="grau_habilidade" type="grau_pericia" defaultValue="'LEIGO'">
                <constraints nullable="false"/>
            </column>
            <column name="pontos_gastos" type="INTEGER" defaultValue="0"/>
            <column name="bonus_diversos" type="INTEGER" defaultValue="0"/>
            <column name="valor_final" type="INTEGER" defaultValue="0"/>
            <column name="is_active" type="BOOLEAN" defaultValue="true">
                <constraints nullable="false"/>
            </column>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de feitiços do personagem -->
        <createTable tableName="feiticos_personagem">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="ficha_personagem_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="feitico_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="nivel_conhecido" type="INTEGER" defaultValue="1"/>
            <column name="especializado" type="BOOLEAN" defaultValue="false"/>
            <column name="is_active" type="BOOLEAN" defaultValue="true">
                <constraints nullable="false"/>
            </column>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de compartilhamento de fichas -->
        <createTable tableName="compartilhamento_ficha">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="ficha_personagem_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="user_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="nivel_acesso" type="VARCHAR(20)"/>
            <column name="link_token" type="VARCHAR(100)">
                <constraints unique="true"/>
            </column>
            <column name="expiracao" type="TIMESTAMP"/>
            <column name="ativo" type="BOOLEAN" defaultValue="true"/>
            <column name="is_active" type="BOOLEAN" defaultValue="true">
                <constraints nullable="false"/>
            </column>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="version" type="INTEGER" defaultValue="1">
                <constraints nullable="false"/>
            </column>
            <column name="created_by_user_id" type="BIGINT"/>
            <column name="updated_by_user_id" type="BIGINT"/>
            <column name="created_ip_address" type="VARCHAR(45)"/>
            <column name="updated_ip_address" type="VARCHAR(45)"/>
            <column name="deleted_at" type="TIMESTAMP"/>
            <column name="deleted_by_user_id" type="BIGINT"/>
        </createTable>
        
        <!-- Tabela de uso_habilidade -->
        <createTable tableName="uso_habilidade">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="habilidade_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="nome" type="VARCHAR(100)"/>
            <column name="descricao" type="TEXT"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de requisitos_classe -->
        <createTable tableName="requisitos_classe">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="classe_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="nivel_minimo" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="primeiro_arquetipo" type="arquetipos_nome">
                <constraints nullable="false"/>
            </column>
            <column name="segundo_arquetipo" type="arquetipos_nome"/>
            <column name="primeiro_arquetipo_nivel" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="segundo_arquetipo_nivel" type="INTEGER"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de talento_poderes_arquetipo -->
        <createTable tableName="talento__poderes_arquetipo">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="arquetipo_id" type="BIGINT"/>
            <column name="requisitos_talentos_poderes_id" type="INTEGER"/>
            <column name="nome" type="VARCHAR(100)">
                <constraints nullable="false"/>
            </column>
            <column name="descricao" type="TEXT">
                <constraints nullable="false"/>
            </column>
            <column name="linhagem" type="BOOLEAN"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de requisitos_talentos_poderes -->
        <createTable tableName="requisitos_talentos_poderes">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="valor_agilidade" type="INTEGER"/>
            <column name="valor_constituicao" type="INTEGER"/>
            <column name="valor_forca" type="INTEGER"/>
            <column name="valor_influencia" type="INTEGER"/>
            <column name="valor_mente" type="INTEGER"/>
            <column name="valor_presenca" type="INTEGER"/>
            <column name="habilidade_id" type="INTEGER"/>
            <column name="grau_habilidade" type="grau_pericia"/>
            <column name="talento_poder_requisito" type="INTEGER"/>
            <column name="linhagem_id" type="INTEGER"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de classes_feitico -->
        <createTable tableName="classes_feitico">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="feitico_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="classe_feitico" type="classes_feiticos"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de caracteristica_arquetipo -->
        <createTable tableName="caracteristica_arquetipo">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="nome" type="VARCHAR(100)">
                <constraints nullable="false"/>
            </column>
            <column name="arquetipo_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="descricao" type="TEXT">
                <constraints nullable="false"/>
            </column>
            <column name="nivel" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de habilidades_arquetipo -->
        <createTable tableName="habilidades_arquetipo">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="arquetipo_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="habilidade_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de proficiencias_arquetipo -->
        <createTable tableName="proficiencias_arquetipo">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="arquetipo_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="proficiencia" type="tipos_proficiencia"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de proficiencias_classe -->
        <createTable tableName="proficiencias_classe">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="classe_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="proficiencia" type="tipos_proficiencia"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    
    <!-- Changeset 3: Adicionar Foreign Keys -->
    <changeSet id="003-add-foreign-keys" author="tdc-sheets">
        <comment>Adição de foreign keys para as tabelas</comment>
        
        <!-- Foreign keys para ficha_personagem -->
        <addForeignKeyConstraint baseTableName="ficha_personagem" baseColumnNames="user_id"
                                 constraintName="fk_ficha_personagem_user"
                                 referencedTableName="user" referencedColumnNames="id"
                                 onDelete="RESTRICT" onUpdate="CASCADE"/>
        
        <addForeignKeyConstraint baseTableName="ficha_personagem" baseColumnNames="origem_id"
                                 constraintName="fk_ficha_personagem_origem"
                                 referencedTableName="origem" referencedColumnNames="id"
                                 onDelete="RESTRICT" onUpdate="CASCADE"/>
        
        <addForeignKeyConstraint baseTableName="ficha_personagem" baseColumnNames="linhagem_id"
                                 constraintName="fk_ficha_personagem_linhagem"
                                 referencedTableName="linhagem" referencedColumnNames="id"
                                 onDelete="RESTRICT" onUpdate="CASCADE"/>
        
        <!-- Foreign keys para user_authority -->
        <addForeignKeyConstraint baseTableName="user_authority" baseColumnNames="user_id"
                                 constraintName="fk_user_authority_user"
                                 referencedTableName="user" referencedColumnNames="id"
                                 onDelete="CASCADE" onUpdate="CASCADE"/>
        
        <addForeignKeyConstraint baseTableName="user_authority" baseColumnNames="authority_id"
                                 constraintName="fk_user_authority_authority"
                                 referencedTableName="authority" referencedColumnNames="id"/>
        
        <!-- Foreign keys para relacionamentos personagem -->
        <addForeignKeyConstraint baseTableName="atributos_personagem" baseColumnNames="ficha_personagem_id"
                                 constraintName="fk_atributos_personagem_ficha"
                                 referencedTableName="ficha_personagem" referencedColumnNames="id"
                                 onDelete="CASCADE" onUpdate="CASCADE"/>
        
        <addForeignKeyConstraint baseTableName="habilidades_personagem" baseColumnNames="ficha_personagem_id"
                                 constraintName="fk_habilidades_personagem_ficha"
                                 referencedTableName="ficha_personagem" referencedColumnNames="id"
                                 onDelete="CASCADE" onUpdate="CASCADE"/>
        
        <addForeignKeyConstraint baseTableName="habilidades_personagem" baseColumnNames="habilidade_id"
                                 constraintName="fk_habilidades_personagem_habilidade"
                                 referencedTableName="habilidade" referencedColumnNames="id"/>
        
        <addForeignKeyConstraint baseTableName="feiticos_personagem" baseColumnNames="ficha_personagem_id"
                                 constraintName="fk_feiticos_personagem_ficha"
                                 referencedTableName="ficha_personagem" referencedColumnNames="id"
                                 onDelete="CASCADE" onUpdate="CASCADE"/>
        
        <addForeignKeyConstraint baseTableName="feiticos_personagem" baseColumnNames="feitico_id"
                                 constraintName="fk_feiticos_personagem_feitico"
                                 referencedTableName="feiticos" referencedColumnNames="id"/>
        
        <addForeignKeyConstraint baseTableName="inventario_personagem" baseColumnNames="ficha_personagem_id"
                                 constraintName="fk_inventario_personagem_ficha"
                                 referencedTableName="ficha_personagem" referencedColumnNames="id"
                                 onDelete="CASCADE" onUpdate="CASCADE"/>
        
        <addForeignKeyConstraint baseTableName="inventario_personagem" baseColumnNames="equipamento_id"
                                 constraintName="fk_inventario_personagem_equipamento"
                                 referencedTableName="equipamentos" referencedColumnNames="id"/>
        
        <addForeignKeyConstraint baseTableName="compartilhamento_ficha" baseColumnNames="ficha_personagem_id"
                                 constraintName="fk_compartilhamento_ficha_ficha"
                                 referencedTableName="ficha_personagem" referencedColumnNames="id"
                                 onDelete="CASCADE" onUpdate="CASCADE"/>
        
        <addForeignKeyConstraint baseTableName="compartilhamento_ficha" baseColumnNames="user_id"
                                 constraintName="fk_compartilhamento_ficha_user"
                                 referencedTableName="user" referencedColumnNames="id"
                                 onDelete="CASCADE" onUpdate="CASCADE"/>
        
        <!-- Foreign keys já existentes -->
        <addForeignKeyConstraint baseTableName="defesa" baseColumnNames="ficha_personagem_id"
                                 constraintName="fk_defesa_ficha_personagem"
                                 referencedTableName="ficha_personagem" referencedColumnNames="id"
                                 onDelete="CASCADE" onUpdate="CASCADE"/>
        
        <addForeignKeyConstraint baseTableName="pv_pp_personagem" baseColumnNames="ficha_personagem_id"
                                 constraintName="fk_pv_pp_personagem_ficha_personagem"
                                 referencedTableName="ficha_personagem" referencedColumnNames="id"
                                 onDelete="CASCADE" onUpdate="CASCADE"/>
        
        <addForeignKeyConstraint baseTableName="arquetipos_personagem" baseColumnNames="ficha_personagem_id"
                                 constraintName="fk_arquetipos_personagem_ficha_personagem"
                                 referencedTableName="ficha_personagem" referencedColumnNames="id"
                                 onDelete="CASCADE" onUpdate="CASCADE"/>
        
        <addForeignKeyConstraint baseTableName="arquetipos_personagem" baseColumnNames="arquetipo_id"
                                 constraintName="fk_arquetipos_personagem_arquetipo"
                                 referencedTableName="arquetipo" referencedColumnNames="id"
                                 onDelete="NO ACTION" onUpdate="NO ACTION"/>
        
        <!-- Unique constraints -->
        <addUniqueConstraint tableName="atributos_personagem" columnNames="ficha_personagem_id, atributo" constraintName="uk_atributos_personagem_ficha_atributo"/>
        <addUniqueConstraint tableName="habilidades_personagem" columnNames="ficha_personagem_id, habilidade_id" constraintName="uk_habilidades_personagem_ficha_habilidade"/>
        <addUniqueConstraint tableName="feiticos_personagem" columnNames="ficha_personagem_id, feitico_id" constraintName="uk_feiticos_personagem_ficha_feitico"/>
    </changeSet>
    
    <!-- Changeset 4: Adicionar origem_id e linhagem_id à ficha_personagem -->
    <changeSet id="004-add-origem-linhagem-to-ficha" author="tdc-sheets">
        <comment>Adição de colunas origem_id e linhagem_id à tabela ficha_personagem</comment>
        
        <addColumn tableName="ficha_personagem">
            <column name="origem_id" type="BIGINT"/>
            <column name="linhagem_id" type="BIGINT"/>
        </addColumn>
        
        <rollback>
            <dropColumn tableName="ficha_personagem" columnName="origem_id"/>
            <dropColumn tableName="ficha_personagem" columnName="linhagem_id"/>
        </rollback>
    </changeSet>
    
    <!-- Changeset 5: Rollback completo -->
    <changeSet id="005-rollback" author="tdc-sheets">
        <comment>Rollback para todas as tabelas criadas</comment>
        
        <!-- Rollback -->
        <rollback>
            <!-- Ordem reversa para evitar problemas de foreign key -->
            DROP TABLE IF EXISTS compartilhamento_ficha;
            DROP TABLE IF EXISTS feiticos_personagem;
            DROP TABLE IF EXISTS habilidades_personagem;
            DROP TABLE IF EXISTS inventario_personagem;
            DROP TABLE IF EXISTS atributos_personagem;
            DROP TABLE IF EXISTS arquetipos_personagem;
            DROP TABLE IF EXISTS pv_pp_personagem;
            DROP TABLE IF EXISTS defesa;
            DROP TABLE IF EXISTS ficha_personagem;
            DROP TABLE IF EXISTS user_authority;
            DROP TABLE IF EXISTS authority;
            DROP TABLE IF EXISTS user;
            DROP TABLE IF EXISTS classe;
            DROP TABLE IF EXISTS tamanho;
            DROP TABLE IF EXISTS particularidade;
            DROP TABLE IF EXISTS equipamentos;
            DROP TABLE IF EXISTS feiticos;
            DROP TABLE IF EXISTS habilidade;
            DROP TABLE IF EXISTS linhagem;
            DROP TABLE IF EXISTS origem;
            DROP TABLE IF EXISTS arquetipo;
            
            -- Drops dos tipos enum
            DROP TYPE IF EXISTS tipos_equipamentos;
            DROP TYPE IF EXISTS tipos_resistencia;
            DROP TYPE IF EXISTS tempo_acoes;
            DROP TYPE IF EXISTS habilidades_resistencia;
            DROP TYPE IF EXISTS tipos_tamanho;
            DROP TYPE IF EXISTS tipos_proficiencia;
            DROP TYPE IF EXISTS tipos_alcance;
            DROP TYPE IF EXISTS tipos_deslocamento;
            DROP TYPE IF EXISTS tipos_sentidos;
            DROP TYPE IF EXISTS raridades;
            DROP TYPE IF EXISTS tipos_dano;
            DROP TYPE IF EXISTS atributos;
            DROP TYPE IF EXISTS grau_pericia;
            DROP TYPE IF EXISTS classes_feiticos;
            DROP TYPE IF EXISTS matriz_feiticos;
            DROP TYPE IF EXISTS arquetipos_nome;
            DROP TYPE IF EXISTS idiomas;
            DROP TYPE IF EXISTS alfabetos;
        </rollback>
    </changeSet>
    
    <!-- Changeset 6: Criação de tabelas pendentes -->
    <changeSet id="006-create-pending-tables" author="tdc-sheets">
        <comment>Criação de tabelas pendentes para o sistema de fichas</comment>
        
        <!-- Tabela de resistencias_personagem -->
        <createTable tableName="resistencias_personagem">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="ficha_personagem_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="tipo_dano" type="tipos_dano">
                <constraints nullable="false"/>
            </column>
            <column name="resistencia" type="INTEGER" defaultValue="0">
                <constraints nullable="false"/>
            </column>
            <column name="aprimorada" type="BOOLEAN" defaultValue="false">
                <constraints nullable="false"/>
            </column>
            <column name="suprema" type="BOOLEAN" defaultValue="false">
                <constraints nullable="false"/>
            </column>
            <column name="lendaria" type="BOOLEAN" defaultValue="false">
                <constraints nullable="false"/>
            </column>
            <column name="invulnerabilidade" type="BOOLEAN" defaultValue="false">
                <constraints nullable="false"/>
            </column>
            <column name="absorcao" type="BOOLEAN" defaultValue="false">
                <constraints nullable="false"/>
            </column>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de sentidos_personagem -->
        <createTable tableName="sentidos_personagem">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="ficha_personagem_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="audicao" type="tipos_sentidos">
                <constraints nullable="false"/>
            </column>
            <column name="mod_audicao" type="INTEGER"/>
            <column name="olfato" type="tipos_sentidos">
                <constraints nullable="false"/>
            </column>
            <column name="mod_olfato" type="INTEGER"/>
            <column name="visao" type="tipos_sentidos">
                <constraints nullable="false"/>
            </column>
            <column name="mod_visao" type="INTEGER"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de acoes_personagem -->
        <createTable tableName="acoes_personagem">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="ficha_personagem_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="acao" type="VARCHAR(100)">
                <constraints nullable="false"/>
            </column>
            <column name="acao_disponivel" type="BOOLEAN" defaultValue="false">
                <constraints nullable="false"/>
            </column>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de ataques_personagem -->
        <createTable tableName="ataques_personagem">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="ficha_personagem_id" type="BIGINT"/>
            <column name="nome" type="VARCHAR(100)"/>
            <column name="atributo" type="atributos"/>
            <column name="habilidade_id" type="BIGINT"/>
            <column name="alcance" type="tipos_alcance"/>
            <column name="dado_bonus" type="INTEGER" defaultValue="0"/>
            <column name="mod_bonus" type="INTEGER" defaultValue="0"/>
            <column name="custo_pp" type="INTEGER"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de dano_ataque -->
        <createTable tableName="dano_ataque">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="ataque_personagem_id" type="BIGINT"/>
            <column name="dado" type="VARCHAR(7)"/>
            <column name="mod" type="INTEGER"/>
            <column name="bonus" type="INTEGER"/>
            <column name="critico" type="VARCHAR(8)"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de feiticos_personagem -->
        <createTable tableName="feiticos_personagem">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="ficha_personagem_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="feiticos_id" type="BIGINT"/>
            <column name="habilidade" type="BIGINT"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de caracteristicas_arquetipos -->
        <createTable tableName="caracteristicas_arquetipos">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="arquetipo_id" type="BIGINT"/>
            <column name="nivel" type="INTEGER"/>
            <column name="descricao" type="TEXT"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de habilidades_classe -->
        <createTable tableName="habilidades_classe">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="classe_id" type="BIGINT"/>
            <column name="nivel" type="INTEGER"/>
            <column name="descricao" type="TEXT"/>
            <column name="primeiro_arquetipo" type="arquetipos_nome">
                <constraints nullable="false"/>
            </column>
            <column name="segundo_arquetipo" type="arquetipos_nome"/>
            <column name="primeiro_arquetipo_nivel" type="INTEGER">
                <constraints nullable="false"/>
            </column>
            <column name="segundo_arquetipo_nivel" type="INTEGER"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de proficiencias_personagem -->
        <createTable tableName="proficiencias_personagem">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="ficha_personagem_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="proficiencia" type="tipos_proficiencia">
                <constraints nullable="false"/>
            </column>
            <column name="proficiente" type="BOOLEAN">
                <constraints nullable="false"/>
            </column>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de atributos_origem -->
        <createTable tableName="atributos_origem">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="origem_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="valor_agilidade" type="INTEGER"/>
            <column name="valor_constituicao" type="INTEGER"/>
            <column name="valor_forca" type="INTEGER"/>
            <column name="valor_influencia" type="INTEGER"/>
            <column name="valor_mente" type="INTEGER"/>
            <column name="valor_presenca" type="INTEGER"/>
            <column name="valor_generico_positivo" type="INTEGER"/>
            <column name="valor_generico_negativo" type="INTEGER"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de itens_origem -->
        <createTable tableName="itens_origem">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="origem_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="equipamento_id" type="INTEGER"/>
            <column name="quantidade" type="INTEGER"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de habilidades_origem -->
        <createTable tableName="habilidades_origem">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="origem_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="habilidade_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="fixa" type="BOOLEAN"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de origem_custom -->
        <createTable tableName="origem_custom">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="ficha_personagem_id" type="BIGINT"/>
            <column name="nome" type="VARCHAR(100)"/>
            <column name="descricao" type="TEXT"/>
            <column name="habilidade_especial" type="TEXT"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de deslocamento_linhagem -->
        <createTable tableName="deslocamento_linhagem">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="linhagem_id" type="BIGINT"/>
            <column name="deslocamento" type="tipos_deslocamento"/>
            <column name="valor" type="INTEGER"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de idiomas_linhagem -->
        <createTable tableName="idiomas_linhagem">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="linhagem_id" type="BIGINT"/>
            <column name="idioma" type="idiomas"/>
            <column name="alfabeto" type="alfabetos"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de atributos_linhagem -->
        <createTable tableName="atributos_linhagem">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="linhagem_id" type="BIGINT"/>
            <column name="valor_agilidade" type="INTEGER"/>
            <column name="valor_constituicao" type="INTEGER"/>
            <column name="valor_forca" type="INTEGER"/>
            <column name="valor_influencia" type="INTEGER"/>
            <column name="valor_mente" type="INTEGER"/>
            <column name="valor_presenca" type="INTEGER"/>
            <column name="valor_generico_positivo" type="INTEGER"/>
            <column name="valor_generico_negativo" type="INTEGER"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de sentidos_linhagem -->
        <createTable tableName="sentidos_linhagem">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="linhagem_id" type="BIGINT"/>
            <column name="audicao" type="tipos_sentidos">
                <constraints nullable="false"/>
            </column>
            <column name="olfato" type="tipos_sentidos">
                <constraints nullable="false"/>
            </column>
            <column name="visao" type="tipos_sentidos">
                <constraints nullable="false"/>
            </column>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de caracteristicas_ancestralidade -->
        <createTable tableName="caracteristicas_ancestralidade">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="linhagem_id" type="BIGINT"/>
            <column name="nome" type="VARCHAR(100)"/>
            <column name="descricao" type="TEXT"/>
            <column name="fixa" type="BOOLEAN"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de carga_personagem -->
        <createTable tableName="carga_personagem">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="ficha_personagem_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="carga_atual" type="INTEGER"/>
            <column name="capacidade_carga" type="INTEGER"/>
            <column name="bonus_capacidade_carga" type="INTEGER"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de cunhagem_personagem -->
        <createTable tableName="cunhagem_personagem">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="carga_personagem_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="c_fisico" type="INTEGER"/>
            <column name="po_fisico" type="INTEGER"/>
            <column name="pp_fisico" type="INTEGER"/>
            <column name="c_banco" type="INTEGER"/>
            <column name="po_banco" type="INTEGER"/>
            <column name="pp_banco" type="INTEGER"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        
        <!-- Tabela de descricao_personagem -->
        <createTable tableName="descricao_personagem">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="ficha_personagem_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="genero" type="VARCHAR(255)"/>
            <column name="pronomes" type="VARCHAR(255)"/>
            <column name="idade" type="VARCHAR(255)"/>
            <column name="altura" type="VARCHAR(255)"/>
            <column name="peso" type="VARCHAR(255)"/>
            <column name="tamanho" type="tipos_tamanho"/>
            <column name="fe" type="VARCHAR(255)"/>
            <column name="pele" type="VARCHAR(255)"/>
            <column name="olhos" type="VARCHAR(255)"/>
            <column name="cabelos" type="VARCHAR(255)"/>
            <column name="aparencia_outros" type="VARCHAR(255)"/>
            <column name="particularidades" type="TEXT"/>
            <column name="conceito" type="TEXT"/>
            <column name="tracos_personalidade" type="TEXT"/>
            <column name="ideais" type="TEXT"/>
            <column name="falhas" type="TEXT"/>
            <column name="medos" type="TEXT"/>
            <column name="aliados" type="TEXT"/>
            <column name="organizacoes" type="TEXT"/>
            <column name="historia" type="TEXT"/>
            <column name="anotacoes" type="TEXT"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de particularidades_personagem -->
        <createTable tableName="particularidades_personagem">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="ficha_personagem_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="particularidade_id" type="BIGINT"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de ficha_snapshot -->
        <createTable tableName="ficha_snapshot">
            <column name="id" type="BIGINT" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="ficha_personagem_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="data_snapshot" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP"/>
            <column name="conteudo_json" type="TEXT">
                <constraints nullable="false"/>
            </column>
            <column name="versao" type="INTEGER" defaultValue="1"/>
            <column name="descricao" type="VARCHAR(255)"/>
            <column name="created_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
            <column name="updated_at" type="TIMESTAMP" defaultValueComputed="CURRENT_TIMESTAMP">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Tabela de feiticos_personagem_habilidades_personagem -->
        <createTable tableName="feiticos_personagem_habilidades_personagem">
            <column name="feiticos_personagem_habilidade" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="habilidades_personagem_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
        </createTable>
        
        <!-- Adicionando foreign keys faltantes na tabela classe -->
        <addForeignKeyConstraint baseTableName="classe" baseColumnNames="requisitos_classe_id"
                             constraintName="fk_classe_requisitos_classe"
                             referencedTableName="requisitos_classe" referencedColumnNames="id"/>
                             
        <!-- Adicionando foreign keys relacionadas a tabelas de uso_habilidade -->
        <addForeignKeyConstraint baseTableName="uso_habilidade" baseColumnNames="habilidade_id"
                             constraintName="fk_uso_habilidade_habilidade"
                             referencedTableName="habilidade" referencedColumnNames="id"/>

        <!-- Adicionando foreign keys relacionadas a tabelas de talentos e poderes -->
        <addForeignKeyConstraint baseTableName="talento__poderes_arquetipo" baseColumnNames="arquetipo_id"
                             constraintName="fk_talento_poderes_arquetipo_arquetipo"
                             referencedTableName="arquetipo" referencedColumnNames="id"/>
                             
        <addForeignKeyConstraint baseTableName="talento__poderes_arquetipo" baseColumnNames="requisitos_talentos_poderes_id"
                             constraintName="fk_talento_poderes_arquetipo_requisitos"
                             referencedTableName="requisitos_talentos_poderes" referencedColumnNames="id"/>
                             
        <addForeignKeyConstraint baseTableName="requisitos_talentos_poderes" baseColumnNames="talento_poder_requisito"
                             constraintName="fk_requisitos_talentos_poderes_talento_poder"
                             referencedTableName="talento__poderes_arquetipo" referencedColumnNames="id"/>
                             
        <addForeignKeyConstraint baseTableName="requisitos_talentos_poderes" baseColumnNames="linhagem_id"
                             constraintName="fk_requisitos_talentos_poderes_linhagem"
                             referencedTableName="linhagem" referencedColumnNames="id"/>
    </changeSet>
</databaseChangeLog>
